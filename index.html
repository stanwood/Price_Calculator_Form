<html>
<head>
</head>
<body>
<!--[if lte IE 8]>
<script charset="utf-8" type="text/javascript" src="//js.hsforms.net/forms/v2-legacy.js"></script>
<![endif]-->
<script charset="utf-8" type="text/javascript" src="https://js.hsforms.net/forms/v2.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<!--[if lte IE 8]>
<script charset="utf-8" type="text/javascript" src="//js.hsforms.net/forms/v2-legacy.js"></script>
<![endif]-->
<!--[if lte IE 8]>
<script charset="utf-8" type="text/javascript" src="//js.hsforms.net/forms/v2-legacy.js"></script>
<![endif]-->
<style>
	.hs-form-field {
		padding: 0 50px 0 0 !important;
	}
	form h1 {
		background: #EEEEEE;
		padding: 20px;
	}
	input {
		margin-right: 10px;
		margin-bottom: 10px;
		margin-top: 10px;
	}
	h1 {
		font-size: 20px !important;
	}
	.padding20tb {
		padding: 0px !important;
	}
	input[type="radio"], input[type="checkbox"] {
		height: 20px !important;
		width: 20px !important;
	}
</style>
<script charset="utf-8" type="text/javascript" src="https://js.hsforms.net/forms/v2.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script>
	window.addEventListener('message', function(event) {

		if(event.data.type === 'hsFormCallback' && event.data.eventName === 'onFormReady') {

			var form = document.getElementsByTagName("form")[0];

			for (var i = 0; i < form.length; i++) {
				form[i].addEventListener('change',updateValue);
			}

			function updateValue(e) {

				var prices = {
					default: 5,
					perPlatform: {
						social: 10,
						offline: 50
					},
					perView: {
						master: 2,
						detail: 2,
						form: 4
					}
				}

				var totalPrice = prices.default * 3; //3 = Wireframes, Design, Estimation

				// Views

				var numberOfMasterViews = e.target.getRootNode().getElementsByName("number_master_views")[0].value;
				var numberOfEditViews = e.target.getRootNode().getElementsByName("number_edit_views")[0].value;


				var priceFeatures = 0;

				// Additional features
				var additionalFeatures = e.target.getRootNode().getElementsByName("additional_features");
				for (var i = 0; i < additionalFeatures.length; i++) {
					if (additionalFeatures[i].checked) {
						switch (additionalFeatures[i].value) {
							case "Erstellen von PDFs (Rechnungen etc.)":
								priceFeatures += 10;
								break;
							case "Analyse der App-Nutzung":
								priceFeatures += 10;
								break;
							case "Nachrichten schreiben (wie in Whatsapp)":
								priceFeatures += 10;
								break;
							case "Kommentieren und \"Liken\"":
								priceFeatures += 10;
								break;
							case "Offline Speichern":
								priceFeatures += 50;
								break;
							default:
								priceFeatures += 5;
						}
					}
				}

				// Advanced features
				var advancedFeatures = e.target.getRootNode().getElementsByName("advanced_features");
				for (var i = 0; i < advancedFeatures.length; i++) {
					if (advancedFeatures[i].checked) {
						switch (advancedFeatures[i].value) {
							case "Erstellen von PDFs (Rechnungen etc.)":
								priceFeatures += 10;
								break;
							case "Analyse der App-Nutzung":
								priceFeatures += 10;
								break;
							default:
								priceFeatures += 5;
								break;
						}
					}
				}

				// CMS

				var contentManagementSystem = e.target.getRootNode().getElementsByName("content_management_system");

				// Number of platforms
				for (var i = 0; i < contentManagementSystem.length; i++) {
					if (contentManagementSystem[i].checked) {
						switch (contentManagementSystem[i].value) {
							case "High end":
								priceFeatures += 30;
								break;
							case "Wordpress oder Ã¤hnlich":
								priceFeatures += 10;
								break;
							default:
								priceFeatures += 0;
								break;
						}
					}
				}

				// Number of platforms
				var numberOfPlatforms = 0;
				var platforms = e.target.getRootNode().getElementsByName("platform")
				for (var i = 0; i < platforms.length; i++) {
					if (platforms[i].checked) {
						numberOfPlatforms++;
					}
				}

				var totalPrice = totalPrice + (priceFeatures + numberOfMasterViews * 2 + numberOfEditViews * 4) * numberOfPlatforms;
				e.target.getRootNode().getElementsByName("cost_estimate")[0].value = totalPrice * 1000;

				//TRACKING
				if (e.eventPhase == 3) { // Those events are fired twice for some reason. Only tracking once.
					dataLayer.push({'form_field_name': e.target.name});
					dataLayer.push({'form_field_value': e.target.value + ": " + e.target.checked});
					dataLayer.push({'form_total_value': totalPrice});
					dataLayer.push({'event': 'price_calculator_form_entry'});
				}
			}
		}
	});

</script>
</body>
</html>