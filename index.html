<html>
<head>
</head>
<body>
<style>

	.calculator_question {
		display: none;
	}
	input {
		margin-right: 10px;
		margin-bottom: 10px;
		margin-top: 10px;
	}
	input[type="radio"], input[type="checkbox"] {
		height: 20px !important;
		width: 20px !important;
	}
</style>
<script>

	var currentQuestion = 0;

	function validEmail(textfield) {

		console.log("validEmail: " + textfield.value);
		var errorLabel = document.getElementById("error");
		var submitButton = document.getElementById("submit");
		if (/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(textfield.value)) {
			errorLabel.innerHTML = "Gut gemacht ;-)";
			errorLabel.style.color = "black";
			submitButton.disabled = false;
		} else {
			errorLabel.innerHTML = "Ung&uuml;ltige E-Mail"
			errorLabel.style.color = "red";
			submitButton.disabled = true;
		}
	}

	function next() {
		currentQuestion++;
		toggleQuestionVisibility();
	}
	function prev() {
		currentQuestion--;
		toggleQuestionVisibility();
	}
	function toggleQuestionVisibility() {
		var questions = 	document.getElementsByClassName("calculator_question");
		for (var i = 0; i < 5; i++) {
			questions[i].style.display = "none";
		}
		questions[currentQuestion].style.display = "block";

		if (currentQuestion == 4) {
			document.getElementById("email")
		}
	}

	window.onload = function() {
		var form = document.getElementsByTagName("form")[0];

		// Constantly update the price to fire GA events
		for (var i = 0; i < form.length; i++) {
			form[i].addEventListener('change', updateValue);
		}
	}

	function updateValue(e) {

		var pricePerFeature = 5;

		var totalPrice = pricePerFeature * 3; //3 = Wireframes, Design, Estimation

		// Number of platforms
		var numberOfPlatforms = 0;
		var platforms = e.target.getRootNode().getElementsByName("platform")
		for (var i = 0; i < platforms.length; i++) {
			if (platforms[i].checked) {
				numberOfPlatforms++;
			}
		}
		if (numberOfPlatforms == 0) {
			numberOfPlatforms = 1;
		}

		// Views
		var numberOfSimpleViews = 0;
		var numberOfComplexViews = 0;
		var views = e.target.getRootNode().getElementsByName("number_of_simple_views");
		for (var i = 0; i < views.length; i++) {
			if (views[i].checked) {
				switch (views[i].value) {
					case "few":
						numberOfSimpleViews = 3;
						break;
					case "medium":
						numberOfSimpleViews = 7;
						break;
					case "loads":
						numberOfSimpleViews = 15;
						break;
					default:
						numberOfSimpleViews = 0;
						break;
				}
			}
		}
		var views = e.target.getRootNode().getElementsByName("number_of_complex_views");
		for (var i = 0; i < views.length; i++) {
			if (views[i].checked) {
				switch (views[i].value) {
					case "few":
						numberOfComplexViews = 3;
						break;
					case "medium":
						numberOfComplexViews = 7;
						break;
					case "loads":
						numberOfComplexViews = 15;
						break;
					default:
						numberOfComplexViews = 0;
						break;
				}
			}
		}

		// Additional features
		var priceFeatures = 0;
		var additionalFeatures = e.target.getRootNode().getElementsByName("features");
		for (var i = 0; i < additionalFeatures.length; i++) {
			if (additionalFeatures[i].checked) {
				priceFeatures += pricePerFeature;
			}
		}

		// CMS
		var cms = e.target.getRootNode().getElementsByName("cms");
		var priceCMS = 0;
		for (var i = 0; i < cms.length; i++) {
			if (cms[i].checked) {
				switch (cms[i].value) {
					case "wordpress":
						priceCMS += 10;
						break;
					case "custom":
						priceCMS += 30;
						break;
					default:
						priceCMS += 0;
						break;
				}
			}
		}

		totalPrice = totalPrice + (priceFeatures + numberOfSimpleViews * pricePerFeature * 0.5 + numberOfComplexViews * pricePerFeature) * numberOfPlatforms + priceCMS;

		e.target.getRootNode().getElementsByName("cost_estimate")[0].innerHTML = totalPrice * 1000;
		console.log(totalPrice);

		//TRACKING
		if (e.eventPhase == 3) { // Those events are fired twice for some reason. Only tracking once.
			dataLayer.push({'form_field_name': e.target.name});
			dataLayer.push({'form_field_value': e.target.value + ": " + e.target.checked});
			dataLayer.push({'form_total_value': totalPrice});
			dataLayer.push({'event': 'price_calculator_form_entry'});
		}
	}
</script>

<div name="cost_estimate">0â‚¬</div>

<form action="https://hooks.zapier.com/hooks/catch/4370689/od27kua/">
	<div class="calculator_question" id="calculator_question_0" style="display: block;">
		<p><b>App Kategorie</b></p>
		<div>
			<input type="radio" onchange="next();" id="category_education" name="category" value="education">
			<label for="category_education">Bildung</label>
		</div>

		<div>
			<input type="radio" onchange="next();" id="category_business" name="category" value="business">
			<label for="category_business">Business</label>
		</div>

		<div>
			<input type="radio" onchange="next();" id="category_entertainment" name="category" value="entertainment">
			<label for="category_entertainment">Entertainment</label>
		</div>
		<div>
			<input type="radio" onchange="next();" id="category_eat_and_drink" name="category" value="eat_and_drink">
			<label for="category_eat_and_drink">Essen &amp; Trinken</label>
		</div>
		<div>
			<input type="radio" onchange="next();" id="category_other" name="category" value="other">
			<input type="text" name="category_other_text" placeholder="Andere" onfocus="document.getElementById('category_other').checked=true;">
		</div>
		<br>
		<button type="button" onclick="next();">Weiter</button>
		<br>
		<label>Frage 1 / 5</label>
	</div><!--#calculator_question_0-->

	<div class="calculator_question" id="calculator_question_1">
		<p><b>Anzahl der Ansichten</b></p>
		<table>
			<tr>
				<td></td>
				<td>0</td>
				<td>1-5</td>
				<td>6-10</td>
				<td>Mehr</td>
			</tr>
			<tr>
				<td>
					Einfach
					<br>
					<small>Listen, Details...</small>
				</td>
				<td><input type="radio" id="number_of_views_simple_none" name="number_of_simple_views" value="none"></td>
				<td><input type="radio" id="number_of_views_simple_few" name="number_of_simple_views" value="few"></td>
				<td><input type="radio" id="number_of_views_simple_medium" name="number_of_simple_views" value="medium"></td>
				<td><input type="radio" id="number_of_views_simple_loads" name="number_of_simple_views" value="loads"></td>
			</tr>
			<tr>
				<td>
					Komplex
					<br>
					<small>Shop, Chat...</small>
				</td>
				<td><input type="radio" onchange="next();" id="number_of_views_complex_none" name="number_of_complex_views" value="none"></td>
				<td><input type="radio" onchange="next();" id="number_of_views_complex_few" name="number_of_complex_views" value="few"></td>
				<td><input type="radio" onchange="next();" id="number_of_views_complex_medium" name="number_of_complex_views" value="medium"></td>
				<td><input type="radio" onchange="next();" id="number_of_views_complex_loads" name="number_of_complex_views" value="loads"></td>
			</tr>
		</table>

		<br>
		<button type="button" onclick="prev();">Zur&uuml;ck</button>
		<button type="button" onclick="next();">Weiter</button>
		<br>
		<label>Frage 2 / 5</label>
	</div><!--#calculator_question_1-->

	<div class="calculator_question" id="calculator_question_2">
		<p><b>Features</b></p>
		<div>
			<input type="checkbox" id="features_account" name="features" value="account">
			<label for="features_account">Benutzerkonto</label>
		</div>
		<div>
			<input type="checkbox" id="features_video" name="features" value="video">
			<label for="features_video">Videos</label>
		</div>
		<div>
			<input type="checkbox" id="features_news" name="features" value="news">
			<label for="features_news">Nachrichten</label>
		</div>
		<div>
			<input type="checkbox" id="features_social" name="features" value="social">
			<label for="features_social">Kommentare & Likes</label>
		</div>
		<div>
			<input type="checkbox" id="features_offline" name="features" value="offline">
			<label for="features_offline">Offline</label>
		</div>
		<div>
			<input type="checkbox" id="features_push" name="features" value="push">
			<label for="features_push">Push-Nachrichten</label>
		</div>
		<div>
			<input type="checkbox" id="features_commerce" name="features" value="commerce">
			<label for="features_commerce">E-Commerce</label>
		</div>
		<div>
			<input type="checkbox" id="features_other" name="features" value="other">
			<input type="text" name="features_othe_textr" placeholder="Andere" onfocus="document.getElementById('features_other').checked=true;">
		</div>

		<br>
		<button type="button" onclick="prev();">Zur&uuml;ck</button>
		<button type="button" onclick="next();">Weiter</button>
		<br>
		<label>Frage 3 / 5</label>
	</div><!--#calculator_question_2-->

	<div class="calculator_question" id="calculator_question_3">
		<p><b>Plattform</b></p>
		<div>
			<input type="checkbox" id="platform_ios" name="platform" value="ios">
			<label for="platform_ios">
				iOS
			</label>
		</div>
		<div>
			<input type="checkbox" id="platform_android" name="platform" value="android">
			<label for="platform_android">
				Android
			</label>
		</div>
		<div>
			<input type="checkbox" id="platform_web" name="platform" value="web">
			<label for="platform_web">Web</label>
		</div>

		<p><b>Content-Management-System (CMS)</b></p>
		<div>
			<input type="radio" onchange="next();" id="cms_none" name="cms" value="none">
			<label for="cms_none">Keines</small>
			</label>
		</div>
		<div>
			<input type="radio" onchange="next();" id="cms_wordpress" name="cms" value="wordpress">
			<label for="cms_wordpress">Einfach z.B. Wordpress</label>
		</div>
		<div>
			<input type="radio" onchange="next();" id="cms_custom" name="cms" value="custom">
			<label for="cms_custom">Auf mich zugeschnitten</label>
		</div>

		<br>
		<button type="button" onclick="prev();">Zur&uuml;ck</button>
		<button type="button" onclick="next();">Weiter</button>
		<br>
		<label>Frage 3 / 5</label>
	</div><!--#calculator_question_3-->

	<div class="calculator_question" id="calculator_question_4">
		<p><b>Kontaktdaten</b></p>
		<p>Wir senden Ihnen Ihre Kostensch&auml;tzung gleich zu.</p>
		<input id="email" type="email" name="email" placeholder="E-Mail" onkeyup="validEmail(this);" onchange="validEmail(this);">
		<br>
		<small id="error">Pflichtfeld</small>
		<br>
		<input type="tel" placeholder="Telefon" name="phone">
		<br>
		<small>Optional f&uuml;r R&uuml;ckfragen</small></p>

		<br>
		<button id="submit" type="button" onclick="prev();">Zur&uuml;ck</button>
		<button type="submit" disabled>Kostensch&auml;tzung anfordern</button>
		<br>
		<label>Frage 5 / 5</label>
	</div><!--#calculator_question_4-->
</form>
</body>
</html>